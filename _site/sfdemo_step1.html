<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>1. Starting the environment | Cloud Integration</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Cloud Integration</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tech Guides<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="sfdemo_start.html">Salesforce Demo</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:andygro@us.ibm.com?subject=Cloud Integration feedback&body=I have some feedback about the 1. Starting the environment page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="1. Starting the environment">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                







<div style="position: fixed;overflow-y: auto;height: 90vh;">
<ul id="mysidebar" class="nav">
    <li class="sidebarTitle"> </li>
    
    
    
    <li>
        <a href="#">Salesforce Demo</a>
        <ul>
            
            
            
            <li><a href="sfdemo_start.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="sfdemo_step0.html">0. Setup Salesforce.com</a></li>
            
            
            
            
            
            
            <li class="active"><a href="sfdemo_step1.html">1. Starting the environment</a></li>
            
            
            
            
            
            
            <li><a href="sfdemo_step2.html">2. Running the demo</a></li>
            
            
            
            
        </ul>
     </li>
       
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
</ul>
</div>
<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">1. Starting the environment</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

  <h2 id="objectives">Objectives</h2>
<ol>
  <li>Deploy the SkyTap-based environment.</li>
  <li>Configure MQSFB and start all required services.</li>
  <li>Configure the App Connect Pro orchestration and redeploy it.</li>
</ol>

<h2 id="11-deploy-skytap-environment">1.1 Deploy SkyTap environment</h2>
<ol>
  <li>
    <p>Log in to <a href="http://cloud.skytap.com">cloud.skytap.com</a>.</p>
  </li>
  <li>
    <p>Under <strong>Environments</strong> -&gt; <strong>Templates</strong> -&gt; <strong>Company</strong>, search for <code class="highlighter-rouge">Cloud Integration for Salesforce Demo v1.0</code> or click <a href="https://cloud.skytap.com/templates/1043585">here</a>.</p>
  </li>
  <li>
    <p>Click <strong>New Environment</strong> to deploy and <strong>Run VMs</strong> <img src="images/sfdemo_step1_runVMs.png" alt="Run VMs" /> to start.</p>
  </li>
</ol>

<h2 id="12-configure-the-runtimes-vm">1.2 Configure the Runtimes VM</h2>

<ol>
  <li>
    <p>Launch the <strong>Runtimes</strong> desktop by clicking on the VM.</p>
  </li>
  <li>
    <p>If necessary, log in with userid <code class="highlighter-rouge">student</code> and password <code class="highlighter-rouge">Passw0rd!</code>.</p>

    <p><strong>Note</strong>: This is the sudo password for any steps required below.</p>
  </li>
  <li>
    <p>Right-click the Desktop and run <strong>Open Terminal Here</strong>.</p>
  </li>
  <li>
    <p>Update the MQSFB configuration to use your Salesforce.com account, in accordance with <a href="https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.0.0/com.ibm.mq.con.doc/q129310_.htm">Knowldge Center</a>.</p>

    <p><strong>Note</strong>: You may find these instructions easier to follow if you convert your Salesforce.com UI from the Salesforce Lightning Experience to the Salesforce Classic Experience.  To do so, click on your avatar icon in the top-right corner and select <strong>Switch to Salesforce Classic</strong>.</p>

    <p>a. Run Step 3 from the <a href="https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.0.0/com.ibm.mq.con.doc/q129310_.htm">Knowldge Center</a>: <em>Create a self-signed security certificate in Salesforce.</em></p>

    <p><strong>Note</strong>: Run this from inside the Runtimes VM to avoid having to transfer the JKS file.</p>

    <p>b. Run Step 4 from the <a href="https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.0.0/com.ibm.mq.con.doc/q129310_.htm">Knowldge Center</a>: <em>Use the IBM Key Management GUI to open the keystore you exported from Salesforce and populate the signer certificates.</em></p>

    <p>c. Run Step 7 from the <a href="https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.0.0/com.ibm.mq.con.doc/q129310_.htm">Knowldge Center</a>: <em>Create a configuration file with connection and security paramters for IBM MQ, Salesforce, and the IBM MQ Bridge to Salesforce behavior.</em></p>

    <p>Use the following commands:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo cp /opt/mqm/mqsf/samp/new_config.cfg /opt/mqm/mqsf/samp/new_config.cfg.bak  
sudo /opt/mqm/bin/runmqsfb -o /opt/mqm/mqsf/samp/new_config.cfg  
sudo chmod 640 /opt/mqm/mqsf/samp/new_config.cfg
</code></pre>
    </div>

    <p>Use the following values:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>Connection to Queue Manager  
---------------------------  
Queue Manager or JNDI CF   : []QM1  
MQ Base Topic              : []/sf  
MQ Channel                 : []SYSTEM.DEF.SVRCONN  
MQ Conname                 : []  
MQ CCDT URL                : []  
JNDI implementation class  : [com.sun.jndi.fscontext.RefFSContextFactory]  
JNDI provider URL          : []  
MQ Userid                  : []  
MQ Password                : []  
</code></pre>
    </div>
    <div class="highlighter-rouge"><pre class="highlight"><code>Connection to Salesforce  
------------------------  
Salesforce Userid (reqd)   : [] **  
Salesforce Password (reqd) : [] **  
Security Token (reqd)      : [] **  
Login Endpoint             : [https://login.salesforce.com]  
Consumer Key               : []  
Consumer Secret            : []  
</code></pre>
    </div>
    <div class="highlighter-rouge"><pre class="highlight"><code>Certificate stores for TLS connections  
--------------------------------------  
Personal keystore for TLS certificates : [] **  
Keystore password          : []  
Trusted store for signer certificates : []  
Trusted store password     : []  
Use TLS for MQ connection  : [N]  
</code></pre>
    </div>
    <div class="highlighter-rouge"><pre class="highlight"><code>Behaviour of bridge program  
---------------------------  
PushTopic Names            : []ShipmentUpgradeRequests  
Platform Event Names       : []  
MQ Monitoring Frequency    : [30]  
At-least-once delivery? (Y/N) : [Y]  
Publish control data with the payload? (Y/N) : [N]  
Delay before starting to process events : [0]  
Runtime logfile for copy of stdout/stderr : []/var/mqm/qmgrs/QM1/errors/mqsfb.out  
Done.
</code></pre>
    </div>
  </li>
  <li>
    <p>If MQ is already running, you will need to restart the mqsfb service.  It is configured to start automatically with the queue manager QM1, so it’s easiest to simply stop the queue manager.  Unfortunately, mqsfb does not shut down automatically, so we need to invoke the following:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>/opt/mqm/bin/endmqm QM1
ps -ef | grep mqsfb | grep -v grep | awk '{print $2}' | xargs sudo kill -9
</code></pre>
    </div>

    <p>If MQ was not running (or now that we stopped it), invoke:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>/opt/mqm/bin/strmqm QM1
/opt/mqm/bin/strmqweb
</code></pre>
    </div>
  </li>
  <li>
    <p>If App Connect Pro is not running, invoke:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>docker start appconnect
</code></pre>
    </div>
  </li>
  <li>
    <p>If MQSubAndPutApp is not running, invoke:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>/opt/mqm/java/jre64/jre/bin/java -Djava.library.path=/opt/mqm/java/lib64 -cp /opt/mqm/java/lib/jms.jar:/opt/mqm/java/lib/com.ibm.mqjms.jar:/home/student/Downloads/JMSRouter.jar com.ibm.mq.test.MQSubAndPutApp QM1 /sf/topic/ShipmentUpgradeRequests SF.SHIPMENTUPGRADEREQUESTS.ACP.QUEUE
</code></pre>
    </div>
  </li>
</ol>

<h2 id="13-configure-the-studio-vm">1.3 Configure the Studio VM</h2>

<ol>
  <li>
    <p>Return to the SkyTap Environment console, and launch the <strong>Studio</strong> desktop by clicking on the VM.</p>
  </li>
  <li>
    <p>If necessary, log in with userid <code class="highlighter-rouge">Adminstrator</code> and password <code class="highlighter-rouge">passw0rd</code>.</p>
  </li>
  <li>
    <p>Launch <strong>Chrome</strong>, and click the <strong>App Connect WMC</strong> bookmark.</p>
  </li>
  <li>
    <p>Login with userid <code class="highlighter-rouge">admin</code> and password <code class="highlighter-rouge">!n0r1t5@C</code></p>
  </li>
  <li>
    <p>From the <strong>Dashboard</strong>, if <code class="highlighter-rouge">CIforSFDemo</code> is <em>Running</em>, click <strong>Stop</strong> (<strong>Cancel Jobs</strong>), and <strong>Undeploy</strong>.</p>
  </li>
  <li>
    <p>Launch <strong>App Connect Studio</strong>, and open the Project file <code class="highlighter-rouge">C:\Student\Projects\CIforSFDemo\CIforSFDemo.sp3</code></p>
  </li>
  <li>
    <p>In the right-hand navigation, under <strong>Endpoints</strong>, open <strong>Salesforce</strong>.</p>
  </li>
  <li>
    <p>Update the userid and password to match your credentials.</p>
  </li>
</ol>

<p><strong>Note</strong>: Password is the concatenation of your password and your security token.  For example, if your password is <code class="highlighter-rouge">passw0rd</code> and your security token is <code class="highlighter-rouge">cGFzc3cwcmQ=</code> then you would enter <code class="highlighter-rouge">passw0rdcGFzc3cwcmQ=</code>.</p>

<ol>
  <li>
    <p><strong>Save</strong> and <strong>publish</strong> the project using userid <code class="highlighter-rouge">admin</code> and password <code class="highlighter-rouge">!n0r1t5@C</code>.</p>
  </li>
  <li>
    <p>Return to the <strong>App Connect WMC</strong> in <strong>Chrome</strong>, and from the <strong>Dashboard</strong>, start the <code class="highlighter-rouge">CIforSFDemo</code> project.</p>
  </li>
</ol>



    <div class="tags">
        
    </div>



</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-6 footer-left">
               &copy;2017 IBM. All rights reserved. <br />
 Site last generated: May 3, 2017 <br />
				</div>
				<div class="col-lg-6 footer-right">
					<p><img src="images/ibm-logo-small.png" alt="IBM"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

</html>
